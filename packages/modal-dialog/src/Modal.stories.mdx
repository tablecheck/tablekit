import { Canvas, Meta, Story, Props } from '@storybook/addon-docs/blocks';

import { Button, ButtonColor } from '@tablecheck/tablekit-button';
import { Size } from '@tablecheck/tablekit-theme';
import faker from 'faker';
import { Fragment, useEffect, useState } from 'react';
import { HeaderAppearance, ModalDialog } from './index';

# Modal dialog

This component displays content in a layer that sits above the rest of the page content.
Users won't be able to interact with the page until the dialog is closed.

<Meta
  title="Components/Modal Dialog"
  component={ModalDialog}
  parameters={{
    options: { isToolshown: true },
    controls: {
      exclude: ['children', 'text', 'id', 'triggerProps'],
      sort: 'alpha'
    }
  }}
  argTypes={{
    headerAppearance: {
      options: [undefined, HeaderAppearance.Warning, HeaderAppearance.Danger],
      description: 'Type of icon to show in Modal header',
      control: {
        type: 'inline-radio'
      }
    },
    footerContent: {
      description: 'Type of icon to show in Modal header',
      control: {
        type: 'text'
      }
    },
    headerContent: {
      description: 'Type of icon to show in Modal header',
      control: {
        type: 'text'
      }
    },
    trigger: {
      control: false
    }
  }}
  args={{
    text: faker.lorem
      .paragraphs(12, '-----')
      .split('-----')
      .map((p) => (
        <Fragment key={p}>
          <h3>{faker.lorem.sentence()}</h3>
          <p>{p}</p>
        </Fragment>
      )),
    headerContent: 'Simple header (maybe custom JSX component)',
    footerContent: 'Simple footer (maybe custom JSX component)',
    hasCloseIcon: true,
    isOpen: false
  }}
/>

export const Template = ({ text, triggerProps = {}, ...modalProps }) => {
  const [isOpen, setOpen] = useState(modalProps.isOpen);
  useEffect(() => {
    setOpen(modalProps.isOpen);
  }, [modalProps.isOpen]);
  return (
    <>
      <ModalDialog {...modalProps} isOpen={isOpen} onOpenChange={setOpen}>
        {text}
      </ModalDialog>
      <Button onClick={() => setOpen(!isOpen)} {...triggerProps}>
        {triggerProps.text || 'Toggle Modal'}
      </Button>
    </>
  );
};

## Minimal markup

```tsx static
import { ModalDialog, ModalTrigger } from '@tablecheck/tablekit-modal-dialog';
import { Button } from '@tablecheck/tablekit-button';

const CustomizedTrigger = (props) => <ModalTrigger as={Button} {...props} />;

const ParentComponent = () => (
  <ModalDialog
    trigger={<CustomizedTrigger>Toggle Modal</CustomizedTrigger>}
    hasCloseIcon
    headerContent="Modal header"
    footerContent="Modal footer"
  >
    Your content goes here!
  </ModalDialog>
);
```

## Minimalistic modal

<Canvas>
  <Story
    name="Base modal"
    args={{
      triggerProps: {
        text: 'Minimalistic settings'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Base modal (without gutters)"
    args={{
      shouldHideGutters: true,
      triggerProps: {
        text: 'Without body gutters'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Children only"
    args={{
      shouldHideGutters: true,
      headerContent: undefined,
      footerContent: undefined,
      triggerProps: {
        text: 'Frame only'
      }
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Header appearances

<Canvas>
  <Story
    name="Header (warning)"
    args={{
      headerAppearance: HeaderAppearance.Warning,
      triggerProps: {
        text: 'Warning',
        color: ButtonColor.Warning
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Header (danger)"
    args={{
      headerAppearance: HeaderAppearance.Danger,
      triggerProps: {
        text: 'Danger',
        color: ButtonColor.Danger
      }
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Modal sizes

<Canvas>
  <Story
    name="Small modal"
    args={{
      width: Size.Small,
      triggerProps: {
        text: 'Small'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Regular modal"
    args={{
      width: Size.Regular,
      triggerProps: {
        text: 'Regular'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Large modal"
    args={{
      width: Size.Large,
      triggerProps: {
        text: 'Large'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="XLarge modal"
    args={{
      width: Size.XLarge,
      triggerProps: {
        text: 'XLarge'
      }
    }}
  >
    {Template.bind({})}
  </Story>
  <Story
    name="Custom width"
    args={{
      width: '200px',
      triggerProps: {
        text: 'Custom width (200px)'
      }
    }}
  >
    {Template.bind({})}
  </Story>
</Canvas>

## Props

- To create uncontrolled modal - pass element (button) to `trigger` prop
- To create controlled modal - pass `onOpenChange` and `isOpen` state

<Props of={ModalDialog} sort="alpha" />

## Custom modals

For custom implementation look into [@radix-ui/react-dialog](https://radix-ui.com/primitives/docs/components/dialog)

Styled wrappers and its radix siblings:

| @tablekit component | @radix component |
| ------------------- | ---------------- |
| ModalTrigger        | Trigger          |
| ModalRoot           | Root             |
| ModalContent        | Content          |
| ModalOverlay        | Overlay          |
| ModalClosePrimitive | Close            |
